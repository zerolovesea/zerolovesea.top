---
title: "ç‰¹å¾å·¥ç¨‹ï¼šç±»åˆ«å˜é‡é™¤äº†ç‹¬çƒ­ç¼–ç è¿˜æœ‰ä»€ä¹ˆç¼–ç ï¼Ÿ"
date: 2024-05-16T20:33:14.000+0800
tags: 
  - ç‰¹å¾å·¥ç¨‹
  - æ•°æ®æŒ–æ˜
  - æœºå™¨å­¦ä¹ 
categories: æ•°æ®æŒ–æ˜
excerpt: æ•°æ®æŒ–æ˜ä¸­å¯¹ç±»åˆ«å˜é‡å¸¸ç”¨çš„é¢„å¤„ç†æ–¹æ³•ã€‚
index_img: https://images.zerolovesea.top/blog/data_mining.jpg
mermaid: true
lang: zh
duration: 18min
---

åœ¨å­¦ä¹ æœºå™¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨å­¦ä¹ å„å¼å„æ ·çš„æ¨¡å‹å‰ï¼Œæ•°æ®é¢„å¤„ç†å¾€å¾€æ˜¯æˆ‘ä»¬æœ€å…ˆå¼€å§‹å­¦ä¹ çš„éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†å†…å®¹çœ‹èµ·æ¥æ²¡æœ‰å„å¼å„æ ·çš„æ¨¡å‹é‚£æ ·æŠ“äººçœ¼çƒï¼Œä½†æ˜¯åœ¨æ•´ä¸ªæœºå™¨å­¦ä¹ æµç¨‹ä¸­æ‰®æ¼”ç€éå¸¸é‡è¦çš„è§’è‰²ã€‚æœ‰ä¸€å¥ç»å…¸çš„è¯ï¼šâ€œæ•°æ®è´¨é‡å†³å®šä¸Šé™ï¼Œè€Œæ¨¡å‹åªæ˜¯é€¼è¿‘è¿™ä¸ªä¸Šé™ã€‚â€

åœ¨åˆšå¼€å§‹æ‰“Kaggleçš„é‚£æ®µæ—¶é—´ï¼Œæˆ‘åªç”¨è¿‡Label Encodingå’ŒOneHot Encodingã€‚è¿™ä¸¤ä¸ªç¼–ç æ–¹å¼å„æœ‰ä¼˜åŠ£ï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼ŒLabel Encodingé€‚åˆæœ‰åºåˆ†ç±»ã€‚OneHot Encodingé€‚åˆæ— åºåˆ†ç±»ï¼Œä½†ä¼šè®©ç»´åº¦çº¿æ€§å¢é•¿ã€‚ä¸€ä¸ªåœºæ™¯å°±æ˜¯åœ°ç‚¹ç‰¹å¾ï¼Œå¦‚æœä¸€ä¸ªåˆ†ç±»ä¸­æœ‰äº”åä¸ªåŸå¸‚ï¼Œç‹¬çƒ­ç¼–ç ä¼šå¸¦æ¥äº”åä¸ªç»´åº¦ï¼Œè€Œæ ‡ç­¾ç¼–ç ä¼šä¸ºä¸åŒåŸå¸‚å¸¦æ¥é”™è¯¯çš„ä½ç½®ä¿¡æ¯ã€‚

æ˜¾ç„¶è¿™ä¸¤ç§ç¼–ç æ–¹å¼ä¸è¶³ä»¥åº”ä»˜æ‰€æœ‰çš„åœºæ™¯ï¼Œå› æ­¤æœ‰å¿…è¦æ¥è§¦å’Œå­¦ä¹ ä¸€ä¸‹æ–°çš„ç¼–ç æ–¹å¼ã€‚Pythonä¸­çš„Category Encodersåº“å°è£…äº†22ç§ç¼–ç æ–¹å¼ï¼Œä»Šå¤©æ¥è§£è¯»ä¸€ä¸‹ã€‚

![](https://images.zerolovesea.top/blog/240516-1.png)


# Ordinal Encoding

é¦–å…ˆæ˜¯Ordinal Encodingï¼Œåºåˆ—ç¼–ç ã€‚è¿™ç§ç¼–ç é’ˆå¯¹çš„æ˜¯æœ‰åºçš„æ ‡ç­¾ï¼Œä¾‹å¦‚å­¦å†ï¼Œç­‰çº§ç­‰ç­‰ã€‚å¯¹äºä¸€ä¸ªå…·æœ‰ ğ‘š ä¸ªç±»åˆ«çš„ç‰¹å¾ ï¼Œæˆ‘ä»¬å°†å…¶å¯¹åº”åœ°æ˜ å°„åˆ° [0,ğ‘šâˆ’1] çš„æ•´æ•°ã€‚

è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæ¯”Label Encoderå¤„ç†çš„æ ‡ç­¾å¢åŠ äº†ç±»åˆ«ä¹‹é—´çš„ç­‰çº§/æ•°å€¼å…³ç³»ã€‚ç¼ºç‚¹æ˜¯ä¸èƒ½å¤„ç†æ— åºæ ‡ç­¾ï¼Œè€Œä¸”ç±»åˆ«ä¹‹å‰çš„è·ç¦»å…³ç³»ä¹Ÿä¸å¤Ÿç²¾ç¡®ã€‚

ä»£ç å®ç°ï¼š

```python
import numpy as np
import pandas as pd
import category_encoders as ce

data = {
    'CustomerID': [1, 2, 3, 4, 5],
    'Satisfaction': ['Satisfied', 'Dissatisfied', 'Neutral', 'Satisfied', 'Dissatisfied'],
    'ProductType': ['Electronics', 'Furniture', 'Electronics', 'Clothing', 'Furniture']
}

X = pd.DataFrame(data)

encoder = ce.OrdinalEncoder(cols=['Satisfaction', 'ProductType'], return_df=True)
numeric_dataset  = encoder.fit_transform(X)
```

é™¤äº†è¿™ç§æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨mapæ–¹æ³•æ¥æ˜ å°„ï¼š

```python
ord_map = {'Gen 1': 1, 'Gen 2': 2, 'Gen 3': 3, 'Gen 4': 4, 'Gen 5': 5, 'Gen 6': 6}
df['Category_Label'] = df['Category_Label'].map(ord_map)
```

# Count Encoding/Frequency Encoding

ä¸‹ä¸€ä¸ªç¼–ç æ–¹å¼æ˜¯é¢‘æ•°ç¼–ç ï¼Œå³å°†ç±»åˆ«ç‰¹å¾æ›¿æ¢ä¸ºåœ¨æ•°æ®é›†ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚å‡å¦‚æŸä¸ªç‰¹å¾å‡ºç°äº†100æ¬¡ï¼Œé‚£ä¹ˆå°±è®°ä½œ100ã€‚

è¿™ç§ç¼–ç æ–¹å¼é€‚åˆé«˜åŸºæ•°çš„æ•°æ®é›†ï¼Œä¹Ÿå°±æ˜¯ç±»åˆ«æ•°ç‰¹åˆ«å¤šã€‚åœ¨å‰é¢æåˆ°çš„å¤šåŸå¸‚åœºæ™¯ï¼Œå®ƒå¯ä»¥ä½œä¸ºä¸€ç§ç¼–ç æ–¹å¼ï¼Œæ¥ä½“ç°åŸå¸‚çš„çƒ­é—¨ç¨‹åº¦ã€‚ä¸è¿‡å®ƒåªè€ƒè™‘ç±»åˆ«è‡ªèº«å‡ºç°çš„æ¬¡æ•°ï¼Œä¸è€ƒè™‘ç±»åˆ«ä¹‹é—´çš„å…³ç³»ï¼Œä¼šä¸¢å¤±ä¸€å®šçš„ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œä¸åŒç±»åˆ«çš„å‡ºç°æ¬¡æ•°å¯èƒ½ä¸€è‡´ï¼Œè¿™ä¹Ÿä¼šå¸¦æ¥ä¸€å®šçš„æ··æ·†ã€‚

```python
import pandas as pd

data = {'Category': ['A', 'B', 'A', 'B', 'A', 'A', 'B', 'A']}
df = pd.DataFrame(data)

frequency_map = df['Category'].value_counts(normalize=True).to_dict()
#frequency_map = df.groupby('Category').size()/len(df)
df['Category_Frequency'] = df['Category'].map(frequency_map)

print(df[['Category', 'Category_Frequency']])
```

![](https://images.zerolovesea.top/blog/240516-3.png)

```python
import category_encoders as ce

data = {
    'CustomerID': [1, 2, 3, 4, 5],
    'Satisfaction': ['Satisfied', 'Dissatisfied', 'Neutral', 'Satisfied', 'Dissatisfied'],
    'ProductType': ['Electronics', 'Furniture', 'Electronics', 'Clothing', 'Furniture']
}

X = pd.DataFrame(data)

encoder = ce.CountEncoder(cols=['Satisfaction', 'ProductType'], return_df=True)
numeric_dataset  = encoder.fit_transform(X)
```

# Binary Encoding/Hash Encoding/Base N Encoding

æˆ‘æŠŠäºŒè¿›åˆ¶ç¼–ç ï¼Œå“ˆå¸Œç¼–ç å’ŒBaseNç¼–ç æ”¾åœ¨äº†ä¸€èµ·ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯åªæ˜¯å°†ç±»åˆ«è¿›è¡Œæ˜ å°„ã€‚

äºŒè¿›åˆ¶ç¼–ç åˆ†ä¸ºä¸¤æ­¥ï¼šå…ˆä¸ºæ¯ä¸ªç±»åˆ«åˆ†é…IDï¼Œå†æ ¹æ®IDç”Ÿæˆå¯¹åº”çš„äºŒè¿›åˆ¶ç¼–ç ã€‚æœ¬è´¨ä¸Šæ˜¯ç”¨äºŒè¿›åˆ¶å¯¹IDè¿›è¡Œå“ˆå¸Œæ˜ å°„ã€‚

å“ˆå¸Œç¼–ç ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œå­—ç¬¦ä¸²å°†è¢«è½¬æ¢ä¸ºä¸€ä¸ªæƒŸä¸€çš„å“ˆå¸Œå€¼ã€‚å¯¹äºç¨€ç–çš„é«˜ç»´ç‰¹å¾ï¼Œå¯ä»¥ä½¿ç”¨å“ˆå¸Œç¼–ç ã€‚

BaseNç¼–ç åˆ™æ˜¯å°†ç±»åˆ«ç¼–ç ä¸ºBase-Nä»£è¡¨çš„æ•°ç»„ï¼ŒNè¶Šé«˜ä»£è¡¨è¾“å‡ºçš„ç»´åº¦è¶Šé«˜ã€‚

```python
import pandas as pd
import category_encoders as ce

data = {
    'Color': ['Red', 'Blue', 'Green', 'Blue', 'Red']
}

X = pd.DataFrame(data)

encoder = ce.HashingEncoder(n_components=3)
numeric_dataset = encoder.fit_transform(X['Color'])

print(numeric_dataset)
```

![](https://images.zerolovesea.top/blog/240516-8.png)

# Target Encoding

ç›®æ ‡ç¼–ç ï¼Œå¯¹äºæ¯ä¸ªç±»åˆ«ï¼Œè®¡ç®—è¯¥ç±»åˆ«ä¸‹ç›®æ ‡å˜é‡çš„å‡å€¼ï¼Œæˆ–è€…å…¶ä»–ç»Ÿè®¡é‡ï¼ˆä¸­ä½æ•°ç­‰ç­‰ï¼‰ã€‚è¿™æ˜¯ä¸€ç§æœ‰ç›‘ç£çš„ç¼–ç æ–¹å¼ã€‚å¦‚æœç›´æ¥ä½¿ç”¨å‡å€¼ï¼Œå¯èƒ½ä¼šè¿‡æ‹Ÿåˆï¼Œåœ¨æ›´æ™®é€‚çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨æ ·æœ¬çš„å…ˆéªŒæ¦‚ç‡å’ŒåéªŒæ¦‚ç‡ç»“åˆæƒé‡å‡½æ•°æ¥å¾—åˆ°å‡å€¼ï¼Œå…¶ä¸­è¿˜ä¼šè¿›è¡Œä¸€äº›è´å¶æ–¯å¹³æ»‘ã€‚

![](https://images.zerolovesea.top/blog/240516-4.png)

```python
data = {
    'CustomerID': [1, 2, 3, 4, 5],
    'Satisfaction': ['Satisfied', 'Dissatisfied', 'Neutral', 'Satisfied', 'Dissatisfied'],
    'ProductType': ['Electronics', 'Furniture', 'Electronics', 'Clothing', 'Furniture'],
    'Target': [1, 0, 0, 1, 0] 
}

df = pd.DataFrame(data)

X = df[['CustomerID', 'Satisfaction', 'ProductType']]
Y = df['Target']

encoder = ce.TargetEncoder(cols=['Satisfaction', 'ProductType'], min_samples_leaf=10, smoothing=1.0)
numeric_dataset = encoder.fit_transform(X, Y)

numeric_dataset
```

![](https://images.zerolovesea.top/blog/240516-6.png)

åŸºäºTarget Encodingçš„æ€æƒ³ï¼Œè¡ç”Ÿå‡ºäº†ä¸åŒçš„ç¼–ç æ–¹å¼ã€‚

## CatBoost Encoding

å’ŒTarget Encodingæ€æƒ³ç±»ä¼¼ï¼ŒCatBoost Encodingä½¿ç”¨ç›®æ ‡å˜é‡çš„ç»Ÿè®¡æ•°æ®ï¼ˆå¦‚å¹³å‡å€¼ï¼‰æ¥æ›¿æ¢æ¯ä¸ªç±»åˆ«ï¼ŒåŒºåˆ«åœ¨äºCatBoost ç¼–ç é‡‡å–äº†ç‰¹æ®Šçš„ç­–ç•¥æ¥é™ä½ç›®æ ‡æ³„éœ²ï¼ˆtarget leakageï¼‰å’Œè¿‡æ‹Ÿåˆçš„é£é™©ã€‚å…¬å¼å¦‚ä¸‹ï¼š$\text{Encoded value} =\frac{\text{TargetSum} + \text{prior}}{\text{FeatureCount} + 1} \tag{1}$ã€‚

- **Target Sum**ï¼šæŒ‡å®šç±»åˆ«åœ¨Target Valueä¸­çš„æ€»å’Œã€‚æ‰¾åˆ°æ‰€æœ‰ç±»åˆ«ä¸ºç›®æ ‡ç±»åˆ«çš„è¡Œï¼Œè®¡ç®—å®ƒä»¬å¯¹åº”çš„Targetçš„å’Œã€‚
- **Prior**ï¼šå¯¹äºæ•´ä¸ªæ•°æ®é›†è€Œè¨€ï¼ŒTargetå€¼çš„æ€»å’Œ/æ‰€æœ‰çš„è§‚æµ‹å˜é‡æ•°ç›®ã€‚è¿™ä¸ªå€¼æ˜¯å›ºå®šçš„ï¼Œå³æ•°æ®çš„è¡Œæ•°/Targetçš„æ€»å’Œã€‚
- **FeatureCount**ï¼šåˆ°ç›®å‰ä¸ºæ­¢å·²ç»çœ‹åˆ°çš„ã€å…·æœ‰ä¸æ­¤ç›¸åŒå€¼çš„åˆ†ç±»ç‰¹å¾çš„æ€»æ•°ã€‚+1é˜²æ­¢åˆ†æ¯ä¸º0ã€‚

ä¾‹å¦‚ï¼Œå¯¹äº `color=["red", "blue", "blue", "green", "red", "red", "black", "black", "blue", "green"] and target column with values, target=[1, 2, 3, 2, 3, 1, 4, 4, 2, 3]`ã€‚

è¿™é‡Œï¼Œå…ˆéªŒ$\text{prior}=25/10=2.5$ã€‚

å¯¹äºåˆ†ç±»`red`ï¼Œ$\text{TargetSum}=1+3+1=5$ï¼Œè€Œ`red`åœ¨ç‰¹å¾ä¸­å‡ºç°äº†3æ¬¡ã€‚å› æ­¤$\text{FeatureCount}=3$ ã€‚æ‰€ä»¥æœ€åç¼–ç ä¸ºï¼š$(5+2.5)/(3+1)=1.875$ã€‚

## M Estimator Encoding

M Estimator Encodingæ˜¯Target Encodingçš„ç®€åŒ–ç‰ˆæœ¬ã€‚ç”¨äºåœ¨ä¿ç•™ç±»åˆ«ä¹‹é—´å·®å¼‚çš„åŒæ—¶ï¼Œé€šè¿‡å¼•å…¥å…¨å±€å‡å€¼æ¥å‡å°‘æ¯ä¸ªç±»åˆ«ä¸­çš„æ–¹å·®ã€‚å®ƒåœ¨å¤„ç†å…·æœ‰å°‘é‡æ ·æœ¬çš„ç±»åˆ«æ—¶æ¯”è¾ƒæœ‰æ•ˆã€‚å…¬å¼å¦‚ä¸‹ï¼š

$\text{Encoded value} = \frac{n \times \text{mean}(y_{\text{category}}) + m \times \text{mean}(y_{\text{global}})}{n + m}$ã€‚

- $n$ æ˜¯å½“å‰ç±»åˆ«ä¸­çš„æ ·æœ¬æ•°é‡ã€‚

- $\text{mean}(y_{\text{category}}) $æ˜¯å½“å‰ç±»åˆ«çš„ç›®æ ‡å‡å€¼ã€‚

- $\text{mean}(y_{\text{global}})$ æ˜¯å…¨æ•°æ®é›†çš„ç›®æ ‡å‡å€¼ã€‚

- $m$ æ˜¯ä¸€ä¸ªå¹³æ»‘å‚æ•°ï¼Œå®ƒå†³å®šäº†å…¨å±€å‡å€¼åœ¨ç¼–ç ä¸­çš„æƒé‡ï¼Œå€¼è¶Šå¤§ï¼Œç¼–ç å€¼è¶Šå€¾å‘äºå…¨å±€å‡å€¼ã€‚

```python
import category_encoders as ce

data = {
    'Color': ['Red', 'Blue', 'Green', 'Blue', 'Red'],
    'Outcome': [1, 0, 1, 0, 1] 
}

df = pd.DataFrame(data)
encoder = ce.MEstimateEncoder(cols=['Color'], m=5.0)  

df_encoded = encoder.fit_transform(df['Color'], df['Outcome'])
print(df_encoded)
```



# Leave One Out

Leave One Outä¹Ÿæ˜¯åŸºäºç›®æ ‡ç¼–ç ï¼Œä¸è¿‡åœ¨ä¼ ç»Ÿçš„ç›®æ ‡ç¼–ç ä¸­ï¼Œç±»åˆ«çš„ç¼–ç å€¼é€šè¿‡è®¡ç®—è¯¥ç±»åˆ«ä¸­æ‰€æœ‰æ ·æœ¬çš„ç›®æ ‡å˜é‡å‡å€¼è·å¾—ã€‚å› ä¸ºå½“å‰æ ·æœ¬çš„ç›®æ ‡å€¼ä¹Ÿå‚ä¸äº†ç¼–ç å€¼çš„è®¡ç®—ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆã€‚ç•™ä¸€ç¼–ç é€šè¿‡å¯¹æ¯ä¸ªæ ·æœ¬è¿›è¡Œç¼–ç æ—¶æ’é™¤è¯¥æ ·æœ¬çš„ç›®æ ‡å€¼ï¼Œæ¥å‡å°‘è¿™ç§è¿‡æ‹Ÿåˆçš„é£é™©ã€‚

å…¬å¼å¦‚ä¸‹ï¼š$\mu_{x_i}^{(-i)} = \frac{\sum_{j \neq i} y_j \cdot \mathbb{I}(x_j = x_i)}{\sum_{j \neq i} \mathbb{I}(x_j = x_i)}$

å…¬å¼è¡¨ç¤ºä¸ºä¸ºç±»åˆ«$x_i$çš„æ ·æœ¬ä¸­ï¼Œæ’é™¤ç¬¬$i$ä¸ªæ ·æœ¬åçš„ç›®æ ‡å˜é‡å‡å€¼ã€‚

**åˆ†å­éƒ¨åˆ†**ï¼šè®¡ç®—ç±»åˆ«ä¸º$x_i$çš„æ ·æœ¬ä¸­ï¼Œæ’é™¤ç¬¬$i$ä¸ªæ ·æœ¬åçš„ç›®æ ‡å˜é‡ä¹‹å’Œã€‚

**åˆ†æ¯éƒ¨åˆ†**ï¼šè®¡ç®—ç±»åˆ«ä¸º$x_i$çš„æ ·æœ¬ä¸­ï¼Œæ’é™¤ç¬¬$i$ä¸ªæ ·æœ¬åçš„æ ·æœ¬æ•°é‡ã€‚

$\mathbb{I}(x_j = x_i)$æ˜¯æŒ‡ç¤ºå‡½æ•°ï¼Œ$x_j = x_i$æ—¶å–å€¼ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚

è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ç±»åˆ«ä¸­ç›®æ ‡å€¼ä¸åŒæ—¶ï¼Œç•™ä¸€ç¼–ç å€¼ä¼šæœ‰æ‰€å˜åŒ–ã€‚

```python
import category_encoders as ce

X = pd.DataFrame(np.array([['male',10],['female', 20], ['male',10], 
                       ['female',20],['female',10],['female',30],['male',10]]),
             columns = ['Sex','Type'])
y = np.array([0,1,1,0,1,0,1])
print(X)

encoder = ce.LeaveOneOutEncoder(cols = ['Sex', 'Type']).fit(X,y)
print(encoder.transform(X))
```

![](https://images.zerolovesea.top/blog/240516-5.png)

# WoE

è¯æ®æƒé‡ï¼ˆWeight of Evidenceï¼‰æ˜¯å…³äºåˆ†ç±»è‡ªå˜é‡å’Œå› å˜é‡ä¹‹é—´å…³ç³»çš„ç¼–ç æ–¹å¼ã€‚æºè‡ªä¿¡ç”¨è¯„åˆ†é¢†åŸŸï¼Œæ›¾ç”¨äºåŒºåˆ†ç”¨æˆ·æ˜¯è¿çº¦æ‹–æ¬ è¿˜æ˜¯å·²ç»å¿è¿˜è´·æ¬¾ã€‚è¯æ®æƒé‡çš„æ•°å­¦å®šä¹‰æ˜¯ä¼˜åŠ¿æ¯”çš„è‡ªç„¶å¯¹æ•°ï¼Œå³ï¼š$\text{WoE} = \log\left(\frac{\text{Non-Events or Goods}}{\text{Events or Bads}}\right)$ã€‚

- **Non-Events or Goods** ï¼šåœ¨æŸä¸ªç‰¹å®šç»„æˆ–æ¡¶ä¸­å¥½å®¢æˆ·çš„æ¯”ä¾‹ã€‚
- **Events or Bads** ï¼šåœ¨åŒä¸€ä¸ªç»„æˆ–æ¡¶ä¸­åå®¢æˆ·çš„æ¯”ä¾‹ã€‚

å¦‚æœä¸€ä¸ªåˆ†ç±»å˜é‡çš„æŸä¸ªç±»åˆ«ä¸­æœ‰ 20% æ˜¯åå®¢æˆ·ï¼ˆeventsï¼‰ï¼Œ80% æ˜¯å¥½å®¢æˆ·ï¼ˆnon-eventsï¼‰ï¼Œé‚£ä¹ˆè¯¥ç±»åˆ«çš„ WoE è®¡ç®—ä¸ºï¼š

$\text{WoE} = \ln\left(\frac{\text{Proportion of Non-Events}}{\text{Proportion of Events}}\right) = \ln\left(\frac{80\%}{20\%}\right) = \ln(4)$

è¿™ä¸ªå€¼è¡¨æ˜è¯¥ç±»åˆ«ç›¸å¯¹äºå…¶ä»–ç±»åˆ«åœ¨åŒºåˆ†å¥½åå®¢æˆ·ä¸Šçš„å¼ºåº¦ã€‚WoE å€¼è¶Šé«˜ï¼Œè¡¨æ˜åœ¨è¯¥ç»„ä¸­çš„å¥½å®¢æˆ·ï¼ˆnon-eventsï¼‰çš„æ¯”ä¾‹è¿œé«˜äºåå®¢æˆ·ï¼ˆeventsï¼‰ã€‚è¿™æ„å‘³ç€è¯¥ç»„çš„é£é™©è¾ƒä½ï¼Œæˆ–è€…è¯´è¯¥ç»„å¯¹äºé¢„æµ‹ç›®æ ‡å˜é‡ï¼ˆæ¯”å¦‚è¿çº¦ï¼‰æ˜¯æœ‰åˆ©çš„ã€‚WoEå€¼è¶Šä½ï¼ˆç‰¹åˆ«æ˜¯è´Ÿå€¼ï¼‰ï¼Œè¡¨ç¤ºè¯¥ç»„ä¸­åå®¢æˆ·çš„æ¯”ä¾‹é«˜äºå¥½å®¢æˆ·ã€‚è¿™æ„å‘³ç€è¯¥ç»„çš„é£é™©è¾ƒé«˜ï¼Œæˆ–è€…è¯´è¯¥ç»„å¯¹äºé¢„æµ‹ç›®æ ‡å˜é‡æ˜¯ä¸åˆ©çš„ã€‚WoEä¸º0ï¼Œåˆ™è¿™ä¸ªç»„ä¸­çš„åˆ†å¸ƒæ˜¯å®Œå…¨éšæœºçš„ï¼Œé¢„æµ‹èƒ½åŠ›å®Œå…¨ä¸å¤Ÿã€‚

WoEçš„é—®é¢˜åœ¨äºæ²¡æœ‰è€ƒè™‘åˆ°å˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œä¹Ÿåªæ˜¯ä»è‡ªèº«ç‰¹å¾å‡ºå‘ã€‚æ­¤å¤–ï¼Œå®ƒåªé€‚ç”¨äºäºŒåˆ†ç±»é—®é¢˜ã€‚

```python
data = {
    'CustomerID': [1, 2, 3, 4, 5],
    'Satisfaction': ['Satisfied', 'Dissatisfied', 'Neutral', 'Satisfied', 'Dissatisfied'],
    'ProductType': ['Electronics', 'Furniture', 'Electronics', 'Clothing', 'Furniture'],
    'Target': [1, 0, 0, 1, 0]  
}

df = pd.DataFrame(data)
target = df['Target']

woe_encoder = ce.WOEEncoder()

df_encoded = woe_encoder.fit_transform(df[['Satisfaction', 'ProductType']], target)
print(df_encoded)
```

![](https://images.zerolovesea.top/blog/240516-7.png)

# æ€»ç»“

- ç¦»æ•£ç‰¹å¾çš„ç±»åˆ«æ•°è¿‡å¤šçš„æƒ…å†µä¸å®œä½¿ç”¨OneHot Encoderï¼Œå®¹æ˜“ç»´åº¦çˆ†ç‚¸ã€‚
- Target Encoderå®¹æ˜“è¿‡æ‹Ÿåˆï¼Œå› æ­¤éœ€è¦åŠ å…¥CVï¼Œæ­£åˆ™é¡¹ã€‚å¯ä»¥è€ƒè™‘ä½¿ç”¨Leave One Outã€‚
- å¯¹äºæœ‰åºç¦»æ•£ç‰¹å¾ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨OrdinalEncoderï¼ŒBinaryEncoderï¼ŒOneHotEncoderï¼ŒLeaveOneOutEncoderï¼ŒTargetEncoderã€‚
- å¯¹äºå›å½’é—®é¢˜ï¼ŒTargetEncoderå’ŒLeaveOneOutEncoderæ•ˆæœå¯èƒ½ä¸€èˆ¬ã€‚
- å¦‚æœç¦»æ•£ç‰¹å¾é«˜åŸºæ•°ï¼Œå¯ä»¥ç”¨LeaveOneOutEncoderï¼ŒWOEEncoderï¼ŒMEstimateEncoderã€‚

2024/5/19 äºè‹å·
